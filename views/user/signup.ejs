<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registration Page</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      height: 100vh;
      margin: 0;
    }
    .button-group {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 10px;
    }
    .signup-btn, .google-btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      text-align: center;
    }
    .signup-btn {
      background: #FFC107;
      color: #343A40;
    }
    .signup-btn:hover {
      background: #E0A800;
    }
    .google-btn {
      background: #343A40;
      color: #FFFFFF;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .google-btn:hover {
      background: #007BFF;
    }
    .registration-container {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      width: 300px;
      text-align: center;
      margin-top: 50px;
    }
    .main {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    h2 {
      margin-bottom: 20px;
    }
    .form-group {
      margin-bottom: 15px;
      text-align: left;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .btn {
      width: 100%;
      padding: 10px;
      background-color: #28a745;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .btn:hover {
      background-color: #218838;
    }
    .google-signin {
      margin-top: 20px;
    }
    .error-message {
      color: red;
      font-size: 0.75em;
      display: none;
    }
    .register-link {
      margin-top: 10px;
      font-size: 0.9em;
    }
    .register-link a {
      color: #007BFF;
      text-decoration: none;
    }
    .register-link a:hover {
      text-decoration: underline;
    }
    /* Styles for the SVG toggle icon */
    .toggle-password {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      width: 18px;
      height: 18px;
      fill: #555;
    }
    .toggle-password:hover {
      fill: #28a745;
    }
    .toggle-password.hidden .eye-slash {
      display: none;
    }
    .toggle-password.visible .eye {
      display: none;
    }
  </style>
</head>
<body>
  <%- include("../../views/partials/user/header") %>
  <div class="main">
    <div class="registration-container">
      <h2>Create an Account</h2>
      <form id="Form" method="post" action="/signup">
        <div class="form-group">
          <label for="fullname">Full Name</label>
          <input type="text" id="name" name="name">
          <div id="error1" class="error-message"></div>
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" name="email">
          <div id="error2" class="error-message"></div>
        </div>
        <div class="form-group">
          <label for="phonenumber">Phone Number</label>
          <input type="tel" id="phonenumber" name="phone">
          <div id="error3" class="error-message"></div>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <div style="position: relative;">
            <input type="password" id="password" name="password">
            <svg id="togglePassword" class="toggle-password hidden" viewBox="0 0 24 24">
              <path class="eye" d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
              <path class="eye-slash" d="M3 3l18 18" stroke="#555" stroke-width="2"/>
            </svg>
          </div>
          <div id="error4" class="error-message"></div>
        </div>
        <div class="form-group">
          <label for="confirmpassword">Confirm Password</label>
          <div style="position: relative;">
            <input type="password" id="confirmpassword" name="cpassword">
            <svg id="toggleConfirmPassword" class="toggle-password hidden" viewBox="0 0 24 24">
              <path class="eye" d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
              <path class="eye-slash" d="M3 3l18 18" stroke="#555" stroke-width="2"/>
            </svg>
          </div>
          <div id="error5" class="error-message"></div>
        </div>
        <div class="form-group">
          <label for="Referalcode" style="display: flex;" placeholder="optional">Referal Code <p style="font-size: small; padding-top: 3.5px;">(optional)</p></label>
          <input type="text" id="referalCode" name="referralCode">
          <div id="error3" class="error-message"></div>
        </div>
        <button type="submit" class="btn">Register</button>
        <a href="/auth/google" class="google-btn">
          <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google Logo" width="20" height="20" style="margin-right: 10px;">
          Sign in with Google
        </a>
        <div class="register-link">
          Have an account? <a href="/login">Login here</a>
        </div>
      </form>
    </div>
  </div>
  <%- include("../../views/partials/user/footer") %>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const form = document.getElementById('Form');
      const name = document.getElementById('name');
      const email = document.getElementById('email');
      const phone = document.getElementById('phonenumber');
      const password = document.getElementById('password');
      const confirmPassword = document.getElementById('confirmpassword');
      const togglePassword = document.getElementById('togglePassword');
      const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
      const referalCode = document.getElementById('referalCode')
      const error1 = document.getElementById('error1');
      const error2 = document.getElementById('error2');
      const error3 = document.getElementById('error3');
      const error4 = document.getElementById('error4');
      const error5 = document.getElementById('error5');

      // Show/Hide Password Toggle for Password field
      togglePassword.addEventListener("click", function () {
        const type = password.getAttribute("type") === "password" ? "text" : "password";
        password.setAttribute("type", type);
        this.classList.toggle("hidden");
        this.classList.toggle("visible");
      });

      // Show/Hide Password Toggle for Confirm Password field
      toggleConfirmPassword.addEventListener("click", function () {
        const type = confirmPassword.getAttribute("type") === "password" ? "text" : "password";
        confirmPassword.setAttribute("type", type);
        this.classList.toggle("hidden");
        this.classList.toggle("visible");
      });

      function nameValidateChecking() {
        const nameval = name.value;
        const namePattern = /^[A-Za-z\s]+$/;

        if (nameval.trim() === "") {
          error1.style.display = "block";
          error1.innerHTML = "Please enter a name";
          return false;
        } else if (!namePattern.test(nameval)) {
          error1.style.display = "block";
          error1.innerHTML = "Name can only contain alphabets and spaces";
          Swal.fire("Enter a valid name");
          return false;
        } else {
          error1.style.display = "none";
          error1.innerHTML = "";
          return true;
        }
      }

      function emailValidateChecking() {
        const emailval = email.value;
        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

        if (!emailPattern.test(emailval)) {
          error2.style.display = "block";
          error2.innerHTML = "Invalid email format";
          Swal.fire("Enter a valid email");
          return false;
        } else {
          error2.style.display = "none";
          error2.innerHTML = "";
          return true;
        }
      }

      function phoneValidateChecking() {
        const phoneval = phone.value;

        if (phoneval.trim() === "") {
          error3.style.display = "block";
          error3.innerHTML = "Invalid phone number";
          return false;
        } else if (phoneval.length !== 10) {
          error3.style.display = "block";
          error3.innerHTML = "Phone number should contain 10 digits";
          return false;
        } else {
          error3.style.display = "none";
          error3.innerHTML = "";
          return true;
        }
      }

      function passValidateChecking() {
        const passval = password.value;
        const cpassval = confirmPassword.value;
        const alpha = /[a-zA-Z]/;
        const digit = /\d/;

        if (passval.length < 8) {
          error4.style.display = "block";
          error4.innerHTML = "Password should be at least 8 characters";
          return false;
        } else if (!alpha.test(passval) || !digit.test(passval)) {
          error4.style.display = "block";
          error4.innerHTML = "Password should contain letters and numbers";
          return false;
        } else {
          error4.style.display = "none";
          error4.innerHTML = "";
        }

        if (passval !== cpassval) {
          error5.style.display = "block";
          error5.innerHTML = "Passwords don't match";
          return false;
        } else {
          error5.style.display = "none";
          error5.innerHTML = "";
          return true;
        }
      }

      form.addEventListener("submit", function (e) {
        let isValid = true;

        if (!nameValidateChecking()) isValid = false;
        if (!emailValidateChecking()) isValid = false;
        if (!phoneValidateChecking()) isValid = false;
        if (!passValidateChecking()) isValid = false;

        if (!isValid) {
          e.preventDefault();
          Swal.fire("Please fill all fields correctly");
        } else {
          Swal.fire({
            icon: "success",
            title: "Redirecting...",
            showConfirmButton: false,
            timer: 1500
          });
        }
      });
    });

    function handleGoogleSignIn(response) {
      const credential = response.credential;
      console.log("Google Sign-In Credential:", credential);
      alert("Google Sign-In successful!");
    }
  </script>
</body>
</html>